import json
import sys


with open(sys.argv[1], encoding="utf8") as vulnF: #path to the file with vulnerable functions
    vulns = json.load(vulnF)

with open(sys.argv[2], encoding="utf8") as input: #path to the file that needs to be checked
    toCheck = json.load(input)

vulnDict = {}
for obj in vulns:
    vulnDict[obj["hash"]] = obj

result = {}
i = 0
total = len(toCheck)
for obj in toCheck:
    i += 1
    if(i%1000==0):
        print("done: ", i, "out of: ", total)
    if obj["hash"] in vulnDict:
        result[obj["hash"]] = {"vulnerable": vulnDict[obj["hash"]], "found": obj}
        print("found")


with open(sys.argv[3], "w") as output:
    json.dump(result, output, indent=4) 